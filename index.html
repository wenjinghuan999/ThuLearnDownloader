<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
    <link href='https://fonts.googleapis.com/css?family=Architects+Daughter' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/pygment_trac.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print">

    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <title>Thulearndownloader by wenjinghuan999</title>
  </head>

  <body>
    <header>
      <div class="inner">
        <h1>Thulearndownloader</h1>
        <h2>A python project which allow you to download all files from learn.tsinghua.edu.cn.</h2>
        <a href="https://github.com/wenjinghuan999/ThuLearnDownloader" class="button"><small>View project on</small>GitHub</a>
      </div>
    </header>

    <div id="content-wrapper">
      <div class="inner clearfix">
        <section id="main-content">
          <h1>
<a name="%E6%B8%85%E5%8D%8E%E7%BD%91%E7%BB%9C%E5%AD%A6%E5%A0%82%E4%B8%8B%E8%BD%BD%E5%99%A8-v10-beta" class="anchor" href="#%E6%B8%85%E5%8D%8E%E7%BD%91%E7%BB%9C%E5%AD%A6%E5%A0%82%E4%B8%8B%E8%BD%BD%E5%99%A8-v10-beta"><span class="octicon octicon-link"></span></a>清华网络学堂下载器 v1.0-beta</h1>

<p><a href="https://github.com/wenjinghuan999/ThuLearnDownloader/releases/tag/v1.0-beta"><code>下载地址</code></a>
<a href="https://github.com/wenjinghuan999/ThuLearnDownloader"><code>源代码</code></a></p>

<h2>
<a name="%E5%8A%9F%E8%83%BD" class="anchor" href="#%E5%8A%9F%E8%83%BD"><span class="octicon octicon-link"></span></a>功能</h2>

<ul>
<li>批量下载网络学堂上的“课程文件”、“教学资源”和“课程作业”中的文件。</li>
<li>可以跳过同目录下已存在的、大小正确的文件。</li>
</ul><h2>
<a name="%E9%9C%80%E6%B1%82" class="anchor" href="#%E9%9C%80%E6%B1%82"><span class="octicon octicon-link"></span></a>需求</h2>

<ul>
<li>Windows：需要安装以下浏览器中至少一个：

<ul>
<li><code>Firefox</code></li>
<li><code>Chrome</code></li>
<li>
<code>Internet Explorer</code>（不支持IE11，详见下方IE用户补充说明）</li>
</ul>
</li>
<li>Linux &amp; Mac：

<ul>
<li>没有经过测试，并不清楚能否运行。</li>
<li>推荐使用Firefox浏览器。使用Chrome浏览器需要安装ChromeDriver。在 <a href="http://chromedriver.storage.googleapis.com/index.html">http://chromedriver.storage.googleapis.com/index.html</a> 中选择合适版本的ChromeDriver下载，将内容解压至本程序drivers文件夹即可。稍后会发Linux版和Mac版，但Mac版不会测试，you know why。</li>
</ul>
</li>
</ul><h2>
<a name="%E4%BD%BF%E7%94%A8%E8%AF%B4%E6%98%8E" class="anchor" href="#%E4%BD%BF%E7%94%A8%E8%AF%B4%E6%98%8E"><span class="octicon octicon-link"></span></a>使用说明</h2>

<ul>
<li>下载zip文件，解压并运行其中的<code>LearnDownloader.exe</code>。</li>
<li>程序以控制台方式运行，但会弹出两个窗口<code>登录</code>、<code>选择需要下载的内容</code>，请按提示操作。登录时也可能弹出错误信息窗口，使用时请注意屏幕上的提示。</li>
<li>程序运行过程中，浏览器将会打开很多窗口，请勿对这些浏览器窗口进行操作，包括在浏览器页面内点击鼠标、拖动滚动条等。你可能可以将浏览器最小化，或者在适当的时机（载入页面的过程中）将其移出屏幕，但它可能还会再次弹出。</li>
<li>确保程序运行过程中浏览器不会被加入新的标签页。</li>
<li>在校外使用时，首页加载可能较慢，请耐心等待浏览器完成页面加载操作。</li>
<li>如果在下载过程中程序发生崩溃或卡死，可以结束程序并重新运行，指定相同的下载目录，已成功下载的文件将被跳过。程序崩溃或卡死的原因可能会有：

<ul>
<li>网络异常导致页面加载不正常。请在网络条件较好时使用本程序。</li>
<li>用户登录超时。当单个文件过大时，下载时间过长，可能发生用户登录超时。此时结束程序并重新运行即可。</li>
<li>你是IE用户。（首先请参考下面的<code>IE用户补充说明</code>。但是我不保证能解决问题，不要问为什么= =）</li>
</ul>
</li>
</ul><h2>
<a name="%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6" class="anchor" href="#%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="octicon octicon-link"></span></a>配置文件</h2>

<p>修改<code>settings.cfg</code>配置文件可以配置程序行为。可用的配置有：</p>

<h3>
<a name="numbers" class="anchor" href="#numbers"><span class="octicon octicon-link"></span></a><code>numbers</code>
</h3>

<table>
<thead><tr>
<th>名称</th>
<th>值</th>
</tr></thead>
<tbody>
<tr>
<td>WAITING_TIME</td>
<td>等待时间（单位：秒）如果出现缺少文件的情况，根据网速情况适当改大。</td>
</tr>
<tr>
<td>DLG_LOGIN_WIDTH</td>
<td>
<code>登录</code>窗口的宽度（单位：像素）如果窗口显示不全等可进行修改，默认300。</td>
</tr>
<tr>
<td>DLG_LOGIN_HEIGHT</td>
<td>
<code>登录</code>窗口的高度（单位：像素），默认150。</td>
</tr>
<tr>
<td>DLG_SEMESTER_WIDTH</td>
<td>
<code>选择需要下载的内容</code>窗口的宽度（单位：像素），默认400。</td>
</tr>
<tr>
<td>DLG_SEMESTER_HEIGHT</td>
<td>
<code>选择需要下载的内容</code>窗口的高度（单位：像素）默认200。</td>
</tr>
</tbody>
</table><h3>
<a name="strings" class="anchor" href="#strings"><span class="octicon octicon-link"></span></a><code>strings</code>
</h3>

<table>
<thead><tr>
<th>名称</th>
<th>值</th>
</tr></thead>
<tbody>
<tr>
<td>USERNAME</td>
<td>用户名默认值</td>
</tr>
<tr>
<td>PASSWORD</td>
<td>密码默认值</td>
</tr>
<tr>
<td>DOWNLOAD_PATH</td>
<td>下载目录默认值</td>
</tr>
<tr>
<td>FILENAME_DOWNLOAD_LOG</td>
<td>错误日志文件名</td>
</tr>
<tr>
<td>FILENAME_FILELIST</td>
<td>下载文件列表文件名</td>
</tr>
</tbody>
</table><h3>
<a name="boolean" class="anchor" href="#boolean"><span class="octicon octicon-link"></span></a><code>boolean</code>
</h3>

<table>
<thead><tr>
<th>名称</th>
<th>值</th>
</tr></thead>
<tbody>
<tr>
<td>USE_FIREFOX</td>
<td>是否尝试使用Firefox浏览器（0或1）</td>
</tr>
<tr>
<td>USE_CHROME</td>
<td>是否尝试使用Chrome浏览器（0或1）</td>
</tr>
<tr>
<td>USE_IE</td>
<td>是否尝试使用IE浏览器（0或1）</td>
</tr>
<tr>
<td>USE_IE_64</td>
<td>是否尝试使用IE浏览器（64位驱动）（0或1）</td>
</tr>
</tbody>
</table><h3>
<a name="%E7%A4%BA%E4%BE%8B%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6" class="anchor" href="#%E7%A4%BA%E4%BE%8B%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6"><span class="octicon octicon-link"></span></a>示例配置文件：</h3>

<pre><code>[numbers]
WAITING_TIME = 1.0

[boolean]
USE_FIREFOX = 1
USE_CHROME = 1
USE_IE = 1
USE_IE_64 = 1

[strings]
USERNAME = wenjh10
PASSWORD = 
DOWNLOAD_PATH = C:\Some\Directory
</code></pre>

<h2>
<a name="ie%E7%94%A8%E6%88%B7%E8%A1%A5%E5%85%85%E8%AF%B4%E6%98%8E" class="anchor" href="#ie%E7%94%A8%E6%88%B7%E8%A1%A5%E5%85%85%E8%AF%B4%E6%98%8E"><span class="octicon octicon-link"></span></a>IE用户补充说明</h2>

<p>首先说明，本人只在Win7 + IE8上测试过，有时可以使用，但有时也会莫名其妙的崩掉或陷入死循环。其他版本可能有其他问题。IE11确定不能使用。</p>

<h3>
<a name="%E5%BF%85%E9%A1%BB%E5%81%9A%E7%9A%84" class="anchor" href="#%E5%BF%85%E9%A1%BB%E5%81%9A%E7%9A%84"><span class="octicon octicon-link"></span></a>必须做的</h3>

<ul>
<li>更改IE安全设置（<code>Internet选项</code>-<code>安全</code>），将所有区域的安全设置恢复成默认级别（官方称应调成同一级别，但实际测试时发现必须全部是默认级别。如果失败可以尝试一下。）将四个区域的“启用保护模式”全部去掉。确定并重新启动IE。</li>
<li>确保你不是第一次运行IE，即确保启动IE时不会出现欢迎对话框。</li>
<li>确保IE启动时不会询问“是否设置为默认浏览器”。</li>
<li>确保IE启动时不会跳转至奇怪的页面，比如“您的浏览器已升级”。</li>
<li>当运行程序时，如果防火墙询问是否允许IEWebdriverServer访问网络，请允许。</li>
</ul><h3>
<a name="%E6%9C%89%E5%8F%AF%E8%83%BD%E5%AF%BC%E8%87%B4%E5%B4%A9%E6%BA%83%E7%9A%84%E5%9B%A0%E7%B4%A0" class="anchor" href="#%E6%9C%89%E5%8F%AF%E8%83%BD%E5%AF%BC%E8%87%B4%E5%B4%A9%E6%BA%83%E7%9A%84%E5%9B%A0%E7%B4%A0"><span class="octicon octicon-link"></span></a>有可能导致崩溃的因素</h3>

<ul>
<li>网速过慢。</li>
<li>“记住密码”对话框。</li>
</ul><h3>
<a name="%E5%A6%82%E6%9E%9C%E4%BD%A0%E4%B8%80%E5%AE%9A%E8%A6%81%E5%B0%9D%E8%AF%95ie11" class="anchor" href="#%E5%A6%82%E6%9E%9C%E4%BD%A0%E4%B8%80%E5%AE%9A%E8%A6%81%E5%B0%9D%E8%AF%95ie11"><span class="octicon octicon-link"></span></a>如果你一定要尝试IE11</h3>

<ul>
<li>确保上述工作已经完成。</li>
<li>在注册表中添加如下键值：</li>
</ul><p>32位：</p>

<pre><code>    [HKEY_LOCAL_MACHINE\SOFTWARE\Microsoft\Internet Explorer\Main\FeatureControl\FEATURE_BFCACHE]
    "iexplore.exe"=dword:00000000
</code></pre>

<p>64位：</p>

<pre><code>    [HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\Microsoft\Internet Explorer\Main\FeatureControl\FEATURE_BFCACHE]
    "iexplore.exe"=dword:00000000
</code></pre>

<ul>
<li>如果仍然不成功，我就没办法了。</li>
</ul><h2>
<a name="%E5%B7%B2%E7%BB%8F%E6%B5%8B%E8%AF%95%E7%9A%84%E9%85%8D%E7%BD%AE" class="anchor" href="#%E5%B7%B2%E7%BB%8F%E6%B5%8B%E8%AF%95%E7%9A%84%E9%85%8D%E7%BD%AE"><span class="octicon octicon-link"></span></a>已经测试的配置</h2>

<ul>
<li>可以运行

<ul>
<li>Win8.1 + Firefox</li>
<li>Win8.1 + Chrome</li>
<li>Win7 + Chrome</li>
<li>Win7 + IE8</li>
</ul>
</li>
<li>不能运行

<ul>
<li>Win8.1 + IE11</li>
</ul>
</li>
</ul>
        </section>

        <aside id="sidebar">
          <a href="https://github.com/wenjinghuan999/ThuLearnDownloader/zipball/master" class="button">
            <small>Download</small>
            .zip file
          </a>
          <a href="https://github.com/wenjinghuan999/ThuLearnDownloader/tarball/master" class="button">
            <small>Download</small>
            .tar.gz file
          </a>

          <p class="repo-owner"><a href="https://github.com/wenjinghuan999/ThuLearnDownloader"></a> is maintained by <a href="https://github.com/wenjinghuan999">wenjinghuan999</a>.</p>

          <p>This page was generated by <a href="https://pages.github.com">GitHub Pages</a> using the Architect theme by <a href="https://twitter.com/jasonlong">Jason Long</a>.</p>
        </aside>
      </div>
    </div>

  
  </body>
</html>